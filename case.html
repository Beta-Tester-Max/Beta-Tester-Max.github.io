<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Case Study Word Editor</title>
    <script src="https://apps.microsoft.com/office-js-dist/office-js/office.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f0f0f0;
      }

      .header {
        background-color: #2b2b5c;
        color: white;
        padding: 10px 20px;
        text-align: center;
      }

      .editor-container {
        display: flex;
        justify-content: center;
        padding: 20px;
        gap: 20px;
      }

      .editor {
        flex: 1;
        background-color: white;
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .editor-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 5px 10px;
        border-bottom: 1px solid #ddd;
      }

      .title-container {
        display: flex;
        align-items: center;
        gap: 10px;
        width: 100%;
      }

      .toolbar {
        display: flex;
        gap: 5px;
        padding: 10px;
        background-color: #f5f5f5;
        border-bottom: 1px solid #ddd;
      }

      .toolbar button {
        padding: 5px 10px;
        background-color: #eaeaea;
        border: 1px solid #ccc;
        border-radius: 3px;
        cursor: pointer;
        font-size: 12px;
      }

      .toolbar button:hover {
        background-color: #d8d8d8;
      }

      #editor {
        width: 100%;
        min-height: 400px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 3px;
        background-color: #ffffff;
        color: #000000;
      }

      .content-preview {
        background-color: #fff;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        min-height: 200px;
        margin-top: 20px;
      }

      #caseTitle {
        width: 100%;
        padding: 5px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin: 5px 0;
      }
    </style>
  </head>

  <body>
    <div class="header">
      <h1>Case Study</h1>
    </div>

    <div class="editor-container">
      <div class="editor">
        <div class="editor-header">
          <div class="title-container">
            <div class="editor-title">Title:</div>
            <input
              type="text"
              id="caseTitle"
              placeholder="Enter case study title"
            />
          </div>
        </div>
        <div class="toolbar">
          <button onclick="document.execCommand('bold', false, null)">B</button>
          <button onclick="document.execCommand('italic', false, null)">
            I
          </button>
          <button onclick="document.execCommand('underline', false, null)">
            U
          </button>
          <button onclick="document.execCommand('formatBlock', false, 'H1')">
            H1
          </button>
          <button onclick="document.execCommand('formatBlock', false, 'H2')">
            H2
          </button>
          <button onclick="document.execCommand('formatBlock', false, 'H3')">
            H3
          </button>
          <button
            onclick="document.execCommand('insertUnorderedList', false, null)"
          >
            UL
          </button>
          <button
            onclick="document.execCommand('insertOrderedList', false, null)"
          >
            OL
          </button>
          <button onclick="document.execCommand('alignLeft', false, null)">
            Left
          </button>
          <button onclick="document.execCommand('alignCenter', false, null)">
            Center
          </button>
          <button onclick="document.execCommand('alignRight', false, null)">
            Right
          </button>
          <button onclick="document.execCommand('justifyFull', false, null)">
            Justify
          </button>
          <button onclick="saveDocument()">Save</button>
        </div>
        <div
          id="editor"
          class="editor-content"
          contenteditable="true"
          spellcheck="false"
        >
          <p>Type your document content here...</p>
        </div>
      </div>
    </div>

    <script>
      // Initialize the editor content
      document.addEventListener("DOMContentLoaded", function () {
        const editor = document.getElementById("editor");

        // Add initial content if empty
        if (editor.innerHTML === "<p>Type your document content here...</p>") {
          editor.innerHTML = "<p></p>";
          const p = editor.firstChild;
          const range = document.createRange();
          range.selectNodeContents(p);
          const selection = window.getSelection();
          selection.removeAllRanges();
          selection.addRange(range);
        }
      });
      document.getElementById("bold").addEventListener("click", function () {
        document.execCommand("bold", false, null);
      });

      // Save document function
      function saveDocument() {
        const caseTitle = document.getElementById("caseTitle").value;
        const editorContent = document.getElementById("editor").innerHTML;

        // Here you would typically use the Word JavaScript API to save the document
        // For this example, we'll just show an alert
        alert(`Document "${caseTitle}" saved successfully!`);
      }
      function saveDocument() {
        const caseTitle = document.getElementById("caseTitle").value;

        Word.run(async (context) => {
          const doc = context.document;
          doc.body.insertParagraph(`Document: ${caseTitle}`, "start");
          doc.save();
          await context.sync();
          alert(`Document "${caseTitle}" saved successfully!`);
        }).catch((error) => {
          console.error("Error saving document:", error);
        });
      }
    </script>
  </body>
</html>
